<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic 6 IP weighting in practice | STAT 394: Causal Inference</title>
  <meta name="description" content="This is the class website for Causal Inference at Macalester College." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic 6 IP weighting in practice | STAT 394: Causal Inference" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the class website for Causal Inference at Macalester College." />
  <meta name="github-repo" content="lmyint/causal_spring_2020" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic 6 IP weighting in practice | STAT 394: Causal Inference" />
  
  <meta name="twitter:description" content="This is the class website for Causal Inference at Macalester College." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="estimating-causal-effects.html"/>
<link rel="next" href="ip-weighting-for-censoring.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #2a211c; color: #bdae9d; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; background-color: #2a211c; color: #bdae9d; border-right: 1px solid #bdae9d; }
td.sourceCode { padding-left: 5px; }
pre, code { color: #bdae9d; background-color: #2a211c; }
code > span.kw { color: #43a8ed; font-weight: bold; } /* Keyword */
code > span.dt { text-decoration: underline; } /* DataType */
code > span.dv { color: #44aa43; } /* DecVal */
code > span.bn { color: #44aa43; } /* BaseN */
code > span.fl { color: #44aa43; } /* Float */
code > span.ch { color: #049b0a; } /* Char */
code > span.st { color: #049b0a; } /* String */
code > span.co { color: #0066ff; font-style: italic; } /* Comment */
code > span.al { color: #ffff00; } /* Alert */
code > span.fu { color: #ff9358; font-weight: bold; } /* Function */
code > span.er { color: #ffff00; font-weight: bold; } /* Error */
code > span.wa { color: #ffff00; font-weight: bold; } /* Warning */
code > span.cn { } /* Constant */
code > span.sc { color: #049b0a; } /* SpecialChar */
code > span.vs { color: #049b0a; } /* VerbatimString */
code > span.ss { color: #049b0a; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { color: #43a8ed; font-weight: bold; } /* ControlFlow */
code > span.op { } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { font-weight: bold; } /* Preprocessor */
code > span.at { } /* Attribute */
code > span.do { color: #0066ff; font-style: italic; } /* Documentation */
code > span.an { color: #0066ff; font-weight: bold; font-style: italic; } /* Annotation */
code > span.co { color: #0066ff; font-weight: bold; font-style: italic; } /* Comment */
code > span.in { color: #0066ff; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="custom_styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href = "./">STAT 394: Causal Inference</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html"><i class="fa fa-check"></i>Schedule</a><ul>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html#week-1"><i class="fa fa-check"></i>Week 1</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html#week-2"><i class="fa fa-check"></i>Week 2</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html#week-3"><i class="fa fa-check"></i>Week 3</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html#week-4"><i class="fa fa-check"></i>Week 4</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html#week-5"><i class="fa fa-check"></i>Week 5</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html#week-6"><i class="fa fa-check"></i>Week 6</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html#week-7"><i class="fa fa-check"></i>Week 7</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html#week-8"><i class="fa fa-check"></i>Week 8</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html#spring-break-316---327"><i class="fa fa-check"></i>Spring Break: 3/16 - 3/27</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html#week-9-330---43"><i class="fa fa-check"></i>Week 9: 3/30 - 4/3</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html#week-10-46---410"><i class="fa fa-check"></i>Week 10: 4/6 - 4/10</a></li>
</ul></li>
<li class="part"><span><b>I Causal Diagram Fundamentals</b></span></li>
<li class="chapter" data-level="1" data-path="introductions-review-and-motivation.html"><a href="introductions-review-and-motivation.html"><i class="fa fa-check"></i><b>1</b> Introductions, Review, and Motivation</a><ul>
<li class="chapter" data-level="" data-path="introductions-review-and-motivation.html"><a href="introductions-review-and-motivation.html#learning-goals"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="introductions-review-and-motivation.html"><a href="introductions-review-and-motivation.html#review-regression-models"><i class="fa fa-check"></i>Review: Regression Models</a></li>
<li class="chapter" data-level="" data-path="introductions-review-and-motivation.html"><a href="introductions-review-and-motivation.html#exercises"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="introductions-review-and-motivation.html"><a href="introductions-review-and-motivation.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="introductions-review-and-motivation.html"><a href="introductions-review-and-motivation.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="introductions-review-and-motivation.html"><a href="introductions-review-and-motivation.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="probability-and-dags.html"><a href="probability-and-dags.html"><i class="fa fa-check"></i><b>2</b> Probability and DAGs</a><ul>
<li class="chapter" data-level="" data-path="probability-and-dags.html"><a href="probability-and-dags.html#learning-goals-1"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="probability-and-dags.html"><a href="probability-and-dags.html#goal-1"><i class="fa fa-check"></i>Goal 1</a></li>
<li class="chapter" data-level="" data-path="probability-and-dags.html"><a href="probability-and-dags.html#lead-in-to-r-activity-poll"><i class="fa fa-check"></i>Lead-in to R activity: Poll</a></li>
<li class="chapter" data-level="" data-path="probability-and-dags.html"><a href="probability-and-dags.html#discussion"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="probability-and-dags.html"><a href="probability-and-dags.html#r-exercises"><i class="fa fa-check"></i>R Exercises</a><ul>
<li class="chapter" data-level="" data-path="probability-and-dags.html"><a href="probability-and-dags.html#exercise-1-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="probability-and-dags.html"><a href="probability-and-dags.html#exercise-2-1"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="probability-and-dags.html"><a href="probability-and-dags.html#exercise-3-1"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probability-and-dags.html"><a href="probability-and-dags.html#conceptual-exercises"><i class="fa fa-check"></i>Conceptual Exercises</a><ul>
<li class="chapter" data-level="" data-path="probability-and-dags.html"><a href="probability-and-dags.html#exercise-4"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="probability-and-dags.html"><a href="probability-and-dags.html#exercise-5"><i class="fa fa-check"></i>Exercise 5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="d-separation-part-1.html"><a href="d-separation-part-1.html"><i class="fa fa-check"></i><b>3</b> d-separation (Part 1)</a><ul>
<li class="chapter" data-level="" data-path="d-separation-part-1.html"><a href="d-separation-part-1.html#learning-goals-2"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="d-separation-part-1.html"><a href="d-separation-part-1.html#discussion-d-separation"><i class="fa fa-check"></i>Discussion: d-separation</a></li>
<li class="chapter" data-level="" data-path="d-separation-part-1.html"><a href="d-separation-part-1.html#discussion-the-birth-weight-paradox"><i class="fa fa-check"></i>Discussion: The Birth Weight Paradox</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="d-separation-part-2.html"><a href="d-separation-part-2.html"><i class="fa fa-check"></i><b>4</b> d-separation (Part 2)</a><ul>
<li class="chapter" data-level="" data-path="d-separation-part-2.html"><a href="d-separation-part-2.html#learning-goals-3"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="d-separation-part-2.html"><a href="d-separation-part-2.html#why-care"><i class="fa fa-check"></i>Why care?</a></li>
<li class="chapter" data-level="" data-path="d-separation-part-2.html"><a href="d-separation-part-2.html#example-folic-acid-and-birth-defects"><i class="fa fa-check"></i>Example: Folic Acid and Birth Defects</a></li>
<li class="chapter" data-level="" data-path="d-separation-part-2.html"><a href="d-separation-part-2.html#example-selection-bias"><i class="fa fa-check"></i>Example: Selection Bias</a></li>
<li class="chapter" data-level="" data-path="d-separation-part-2.html"><a href="d-separation-part-2.html#example-estrogens-and-uterine-cancer"><i class="fa fa-check"></i>Example: Estrogens and Uterine Cancer</a></li>
<li class="chapter" data-level="" data-path="d-separation-part-2.html"><a href="d-separation-part-2.html#principles-of-building-causal-diagrams"><i class="fa fa-check"></i>Principles of building causal diagrams</a></li>
</ul></li>
<li class="part"><span><b>II Causal Effect Estimation</b></span></li>
<li class="chapter" data-level="5" data-path="estimating-causal-effects.html"><a href="estimating-causal-effects.html"><i class="fa fa-check"></i><b>5</b> Estimating causal effects</a><ul>
<li class="chapter" data-level="" data-path="estimating-causal-effects.html"><a href="estimating-causal-effects.html#learning-goals-4"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="estimating-causal-effects.html"><a href="estimating-causal-effects.html#exercise-dag-construction"><i class="fa fa-check"></i>Exercise: DAG construction</a></li>
<li class="chapter" data-level="" data-path="estimating-causal-effects.html"><a href="estimating-causal-effects.html#warm-up-d-separation"><i class="fa fa-check"></i>Warm-up: d-separation</a></li>
<li class="chapter" data-level="" data-path="estimating-causal-effects.html"><a href="estimating-causal-effects.html#discussion-estimating-causal-effects"><i class="fa fa-check"></i>Discussion: Estimating causal effects</a><ul>
<li class="chapter" data-level="" data-path="estimating-causal-effects.html"><a href="estimating-causal-effects.html#worksheet-developing-ideas"><i class="fa fa-check"></i>Worksheet: developing ideas</a></li>
<li class="chapter" data-level="" data-path="estimating-causal-effects.html"><a href="estimating-causal-effects.html#notes-deriving-inverse-probability-weighting"><i class="fa fa-check"></i>Notes: deriving inverse probability weighting</a></li>
<li class="chapter" data-level="" data-path="estimating-causal-effects.html"><a href="estimating-causal-effects.html#exercise-simulation-planning"><i class="fa fa-check"></i>Exercise: Simulation planning</a></li>
<li class="chapter" data-level="" data-path="estimating-causal-effects.html"><a href="estimating-causal-effects.html#simulation-example"><i class="fa fa-check"></i>Simulation example</a></li>
<li class="chapter" data-level="" data-path="estimating-causal-effects.html"><a href="estimating-causal-effects.html#on-your-own"><i class="fa fa-check"></i>On your own</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ip-weighting-in-practice.html"><a href="ip-weighting-in-practice.html"><i class="fa fa-check"></i><b>6</b> IP weighting in practice</a><ul>
<li class="chapter" data-level="" data-path="ip-weighting-in-practice.html"><a href="ip-weighting-in-practice.html#learning-goals-5"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="ip-weighting-in-practice.html"><a href="ip-weighting-in-practice.html#discussion-1"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="ip-weighting-in-practice.html"><a href="ip-weighting-in-practice.html#analysis"><i class="fa fa-check"></i>Analysis</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ip-weighting-for-censoring.html"><a href="ip-weighting-for-censoring.html"><i class="fa fa-check"></i><b>7</b> IP weighting for censoring</a><ul>
<li class="chapter" data-level="" data-path="ip-weighting-for-censoring.html"><a href="ip-weighting-for-censoring.html#learning-goals-6"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="ip-weighting-for-censoring.html"><a href="ip-weighting-for-censoring.html#discussion-2"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="ip-weighting-for-censoring.html"><a href="ip-weighting-for-censoring.html#exercises-1"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="ip-weighting-for-censoring.html"><a href="ip-weighting-for-censoring.html#setup"><i class="fa fa-check"></i>Setup</a></li>
<li class="chapter" data-level="" data-path="ip-weighting-for-censoring.html"><a href="ip-weighting-for-censoring.html#part-1-modeling-to-obtain-weights"><i class="fa fa-check"></i>Part 1: Modeling to obtain weights</a></li>
<li class="chapter" data-level="" data-path="ip-weighting-for-censoring.html"><a href="ip-weighting-for-censoring.html#part-2-fitting-msms"><i class="fa fa-check"></i>Part 2: Fitting MSMs</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Causal Discovery</b></span></li>
<li class="chapter" data-level="8" data-path="causal-discovery.html"><a href="causal-discovery.html"><i class="fa fa-check"></i><b>8</b> Causal Discovery</a><ul>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#learning-goals-7"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#discussion-3"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercises-2"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-1-2"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-2-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-3-2"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-4-1"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-5-1"><i class="fa fa-check"></i>Exercise 5</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-6"><i class="fa fa-check"></i>Exercise 6</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-7"><i class="fa fa-check"></i>Exercise 7</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-8"><i class="fa fa-check"></i>Exercise 8</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Sensitivity Analyses</b></span></li>
<li class="chapter" data-level="9" data-path="sensitivity-analyses-for-unmeasured-confounding.html"><a href="sensitivity-analyses-for-unmeasured-confounding.html"><i class="fa fa-check"></i><b>9</b> Sensitivity Analyses for Unmeasured Confounding</a><ul>
<li class="chapter" data-level="" data-path="sensitivity-analyses-for-unmeasured-confounding.html"><a href="sensitivity-analyses-for-unmeasured-confounding.html#learning-goals-8"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="sensitivity-analyses-for-unmeasured-confounding.html"><a href="sensitivity-analyses-for-unmeasured-confounding.html#exercises-3"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="part"><span><b>V Mediation Analysis</b></span></li>
<li class="chapter" data-level="10" data-path="graphical-structure-of-mediation.html"><a href="graphical-structure-of-mediation.html"><i class="fa fa-check"></i><b>10</b> Graphical Structure of Mediation</a><ul>
<li class="chapter" data-level="" data-path="graphical-structure-of-mediation.html"><a href="graphical-structure-of-mediation.html#learning-goals-9"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="graphical-structure-of-mediation.html"><a href="graphical-structure-of-mediation.html#warm-up"><i class="fa fa-check"></i>Warm-up</a></li>
<li class="chapter" data-level="" data-path="graphical-structure-of-mediation.html"><a href="graphical-structure-of-mediation.html#exercises-4"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="graphical-structure-of-mediation.html"><a href="graphical-structure-of-mediation.html#background"><i class="fa fa-check"></i>Background</a></li>
<li class="chapter" data-level="" data-path="graphical-structure-of-mediation.html"><a href="graphical-structure-of-mediation.html#exercise-1-3"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="graphical-structure-of-mediation.html"><a href="graphical-structure-of-mediation.html#exercise-2-3"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="graphical-structure-of-mediation.html"><a href="graphical-structure-of-mediation.html#exercise-3-3"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="applied-mediation-analysis.html"><a href="applied-mediation-analysis.html"><i class="fa fa-check"></i><b>11</b> Applied Mediation Analysis</a><ul>
<li class="chapter" data-level="" data-path="applied-mediation-analysis.html"><a href="applied-mediation-analysis.html#learning-goals-10"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="applied-mediation-analysis.html"><a href="applied-mediation-analysis.html#discussion-4"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="applied-mediation-analysis.html"><a href="applied-mediation-analysis.html#exercises-5"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="applied-mediation-analysis.html"><a href="applied-mediation-analysis.html#data-context"><i class="fa fa-check"></i>Data context</a></li>
<li class="chapter" data-level="" data-path="applied-mediation-analysis.html"><a href="applied-mediation-analysis.html#exercise-1-4"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="applied-mediation-analysis.html"><a href="applied-mediation-analysis.html#exercise-2-4"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="applied-mediation-analysis.html"><a href="applied-mediation-analysis.html#exercise-3-4"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="applied-mediation-analysis.html"><a href="applied-mediation-analysis.html#exercise-4-2"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="applied-mediation-analysis.html"><a href="applied-mediation-analysis.html#exercise-5-2"><i class="fa fa-check"></i>Exercise 5</a></li>
<li class="chapter" data-level="" data-path="applied-mediation-analysis.html"><a href="applied-mediation-analysis.html#exercise-6-1"><i class="fa fa-check"></i>Exercise 6</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VI Study Designs</b></span></li>
<li class="chapter" data-level="12" data-path="rct-and-iv-designs.html"><a href="rct-and-iv-designs.html"><i class="fa fa-check"></i><b>12</b> RCT and IV designs</a><ul>
<li class="chapter" data-level="" data-path="rct-and-iv-designs.html"><a href="rct-and-iv-designs.html#learning-goals-11"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="rct-and-iv-designs.html"><a href="rct-and-iv-designs.html#warm-up-1"><i class="fa fa-check"></i>Warm-up</a></li>
<li class="chapter" data-level="" data-path="rct-and-iv-designs.html"><a href="rct-and-iv-designs.html#discussion-5"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="rct-and-iv-designs.html"><a href="rct-and-iv-designs.html#exercises-6"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="rct-and-iv-designs.html"><a href="rct-and-iv-designs.html#iv-assumptions"><i class="fa fa-check"></i>IV assumptions</a></li>
<li class="chapter" data-level="" data-path="rct-and-iv-designs.html"><a href="rct-and-iv-designs.html#simulation-planning"><i class="fa fa-check"></i>Simulation planning</a></li>
<li class="chapter" data-level="" data-path="rct-and-iv-designs.html"><a href="rct-and-iv-designs.html#simulation-setting-up-helper-functions"><i class="fa fa-check"></i>Simulation: setting up helper functions</a></li>
<li class="chapter" data-level="" data-path="rct-and-iv-designs.html"><a href="rct-and-iv-designs.html#running-the-simulation"><i class="fa fa-check"></i>Running the simulation</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VII Homework</b></span></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html"><i class="fa fa-check"></i>Homework 1</a><ul>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#conceptual-exercises-1"><i class="fa fa-check"></i>Conceptual Exercises</a><ul>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#exercise-1-5"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#exercise-2-5"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#exercise-3-5"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#simulation-exercises"><i class="fa fa-check"></i>Simulation Exercises</a><ul>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#exercise-4-3"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#exercise-5-3"><i class="fa fa-check"></i>Exercise 5</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#exercise-6-2"><i class="fa fa-check"></i>Exercise 6</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#exercise-7-1"><i class="fa fa-check"></i>Exercise 7</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#portfolio"><i class="fa fa-check"></i>Portfolio</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html"><i class="fa fa-check"></i>Homework 2</a><ul>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#in-class-activities-estimating-causal-effects"><i class="fa fa-check"></i>In-class activities: Estimating causal effects</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#in-class-activities-ip-weighting-in-practice"><i class="fa fa-check"></i>In-class activities: IP weighting in practice</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-3.html"><a href="homework-3.html"><i class="fa fa-check"></i>Homework 3</a></li>
<li class="part"><span><b>VIII Projects</b></span></li>
<li class="chapter" data-level="" data-path="portfolio-1.html"><a href="portfolio-1.html"><i class="fa fa-check"></i>Portfolio</a><ul>
<li class="chapter" data-level="" data-path="portfolio-1.html"><a href="portfolio-1.html#required-topics"><i class="fa fa-check"></i>Required Topics</a><ul>
<li class="chapter" data-level="" data-path="portfolio-1.html"><a href="portfolio-1.html#post-1"><i class="fa fa-check"></i>Post 1</a></li>
<li class="chapter" data-level="" data-path="portfolio-1.html"><a href="portfolio-1.html#post-2"><i class="fa fa-check"></i>Post 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="portfolio-1.html"><a href="portfolio-1.html#iterative-progress"><i class="fa fa-check"></i>Iterative Progress</a></li>
<li class="chapter" data-level="" data-path="portfolio-1.html"><a href="portfolio-1.html#building-a-personal-website"><i class="fa fa-check"></i>Building a Personal Website</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STAT 394: Causal Inference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ip-weighting-in-practice" class="section level1">
<h1><span class="header-section-number">Topic 6</span> IP weighting in practice</h1>
<div id="learning-goals-5" class="section level2 unnumbered">
<h2>Learning Goals</h2>
<ol style="list-style-type: decimal">
<li>Practice an analysis workflow from start to finish</li>
<li>Formulate generalized causal research questions using marginal structural models</li>
<li>Interpret results from fitting MSMs</li>
</ol>
<p><br><br><br><br></p>
</div>
<div id="discussion-1" class="section level2 unnumbered">
<h2>Discussion</h2>
<p>Last time, we derived the following result:</p>
<p>If treatment <span class="math inline">\(A\)</span> and outcome <span class="math inline">\(Y\)</span> are d-separated given <span class="math inline">\(Z\)</span> under the null, we can estimate desired “do” probabilities with a weighted average of the outcomes:</p>
<p><span class="math display">\[ P(Y = 1 \mid \hbox{do}(A = a)) = \frac{\sum_i w_i y_i}{\sum_i w_i} \]</span></p>
<p>where the weights <span class="math inline">\(w_i\)</span> are the inverse propensity scores:</p>
<ul>
<li><span class="math inline">\(w_i = 1/P(A = 1 \mid Z)\)</span> if <span class="math inline">\(a = 1\)</span></li>
<li><span class="math inline">\(w_i = 1/P(A = 0 \mid Z)\)</span> if <span class="math inline">\(a = 0\)</span></li>
</ul>
<p>When <span class="math inline">\(Z\)</span> contains many variables, we need to <strong>model</strong> treatment as a function of the variables in <span class="math inline">\(Z\)</span> to obtain estimates of the propensity scores. Can use:</p>
<ul>
<li>Logistic regression</li>
<li>Other techniques from Statistical Machine Learning</li>
</ul>
<p><br><br><br><br></p>
<p>In particular, this weighted average</p>
<p><span class="math display">\[ P(Y = 1 \mid \hbox{do}(A = a)) = \frac{\sum_i w_i y_i}{\sum_i w_i} \]</span></p>
<p>is specific to the situation where <span class="math inline">\(Y\)</span> is a binary outcome variable, and we want to know <span class="math inline">\(P(Y = 1)\)</span> (which also happens to be equal to the expected value of <span class="math inline">\(Y\)</span>: <span class="math inline">\(E[Y] = P(Y = 1)\)</span>).</p>
<p>Inverse probability weighting works more generally:</p>
<ul>
<li>Treatment <span class="math inline">\(A\)</span> does not have to be binary
<ul>
<li>A continuous treatment is generally difficult to work with</li>
<li>Categorical treatments with 3+ categories are naturally handled with extensions of logistic regression (e.g., multinomial regression, other statistical machine learning methods)</li>
</ul></li>
<li>Outcome <span class="math inline">\(Y\)</span> does not have to be binary</li>
</ul>
<p><br><br><br><br></p>
<p>Recall from our tree diagrams that inverse probability weighting (see our worksheet with solutions <a href="https://docs.google.com/presentation/d/1BEK75PKWGWSmL9FxDmKLevJwPOXFsl70LtHJAnXZAko/edit?usp=sharing">here</a>)</p>
<ul>
<li>upweights the treated to create a population where everyone had been treated</li>
<li>upweights the untreated to create a population where everyone had been untreated</li>
</ul>
<p>In these two populations, we counted up the number of instances where <span class="math inline">\(Y=1\)</span> to obtain our “do” probabilities of interest.</p>
<ul>
<li>In essence, the IP weighting created these populations of all treated and all untreated.
<ul>
<li>Considered together, these two populations are called a <strong>pseudopopulation</strong> because everyone exists twice (as a treated and as an untreated individual).</li>
</ul></li>
<li>In this pseudopopulation, we essentially fit the simple logistic regression model:</li>
</ul>
<p><span class="math display">\[ \log\hbox{odds}(Y = 1) = \beta_0 + \beta_1 A \]</span></p>
<ul>
<li>So in summary: we fit a logistic regression model using inverse probability weights.
<ul>
<li>Each individual received the appropriate <span class="math inline">\(1/P(A=1\mid Z)\)</span> or <span class="math inline">\(1/P(A=0\mid Z)\)</span> weight.</li>
<li>Normally with ordinary unweighted logistic regression, every individual receives a weight of 1. (They appear exactly once in the dataset.)</li>
</ul></li>
</ul>
<p><br><br><br><br></p>
<p>We can make this idea more general:</p>
<ul>
<li>The inverse probability weights effectively repeat certain individuals a number of times so that their data “represents” the other individuals who had received another value of the treatment variable.
<ul>
<li>The IP weights create the pseudopopulation where each individual receives every version of the treatment variable.</li>
</ul></li>
<li>We can fit any model we want (e.g., linear regression, logistic regression) in this pseudopopulation to relate the outcome to the treatment variable.
<ul>
<li>The process of fitting such a model (i.e., fitting a standard regression model supplemented with IP weights) is the process of fitting <strong>marginal structural models</strong></li>
</ul></li>
</ul>
<p><br><br><br><br></p>
<p>New notation:</p>
<ul>
<li>The <span class="math inline">\(Y\)</span> that results when we <span class="math inline">\(\hbox{do}(A=1)\)</span> can also be notated as <span class="math inline">\(Y^{a=1}\)</span>, called the <strong>potential outcome under treatment</strong>.</li>
<li>The <span class="math inline">\(Y\)</span> that results when we <span class="math inline">\(\hbox{do}(A=0)\)</span> can also be notated as <span class="math inline">\(Y^{a=0}\)</span>, called the <strong>potential outcome under no treatment</strong>.</li>
<li>In general the potential outcome when we <span class="math inline">\(\hbox{do}(A=a)\)</span> is denoted <span class="math inline">\(Y^a\)</span>.
<ul>
<li>In words, this potential outcome means: “the outcome that would result if we intervened to set <span class="math inline">\(A=a\)</span>”</li>
</ul></li>
</ul>
<p>A <strong>marginal structural model (MSM)</strong> is a model that relates <em>potential outcomes</em> <span class="math inline">\(Y^a\)</span> to the treatment variable (as opposed to the naturally observed outcomes <span class="math inline">\(Y\)</span>):</p>
<ul>
<li>A linear regression MSM for continuous/quantitative outcomes <span class="math inline">\(Y\)</span>:</li>
</ul>
<p><span class="math display">\[ E[Y^a] = \beta_0 + \beta_1 a \]</span></p>
<ul>
<li>A logistic regression MSM for binary outcomes <span class="math inline">\(Y\)</span>:</li>
</ul>
<p><span class="math display">\[ \log\left( \frac{P(Y^a = 1)}{1-P(Y^a = 1)} \right) = \beta_0 + \beta_1 a \]</span></p>
<p><br><br></p>
<p>Where does the name “marginal structural model” come from?</p>
<ul>
<li>Marginal: refers to the fact that the marginal mean (as opposed to a conditional mean, which is a mean in a subgroup) is being modeled (much like how it’s used in “marginally dependent/independent”)</li>
<li>Structural: In general models in causal inference that describe potential outcomes are referred to as “structural” to indicate a describing of relationships beyond only associations</li>
</ul>
<p><br><br><br><br></p>
</div>
<div id="analysis" class="section level2 unnumbered">
<h2>Analysis</h2>
<p>A template Rmd is available <a href="template_rmds/06-ipw-in-practice.Rmd">here</a>.</p>
<p>Our data come from the National Health and Nutrition Examination Survey Data I Epidemiologic Follow-up Study (NHEFS).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readr)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(ggplot2)

nhefs &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://cdn1.sph.harvard.edu/wp-content/uploads/sites/1268/1268/20/nhefs.csv&quot;</span>)</code></pre></div>
<p>Download the codebook for the dataset <a href="https://cdn1.sph.harvard.edu/wp-content/uploads/sites/1268/2012/10/NHEFS_Codebook.xls">here</a>, and have it open for reference.</p>
<blockquote>
<p><strong>Research goal:</strong> What is the average causal effect of smoking cessation on weight gain at a follow-up visit about 10 years later?</p>
</blockquote>
<p><strong>Part 1: Getting a feel for the data</strong></p>
<p>Tabulate the treatment variable <code>qsmk</code>, visualize the outcome variable, and get summary statistics for the outcome variable.</p>
<p>How many missing values are there for these variables? What key implication does this have for our DAG?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Tabulate with the count() function from dplyr</span>
<span class="co"># count() does show NAs, if present</span>
nhefs <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">count</span>(qsmk)

<span class="co"># Construct a visualization of the weight gain variable</span>


<span class="co"># Summary statistics for the weight gain variable</span>
<span class="kw">summary</span>(nhefs<span class="op">$</span>wt82_<span class="dv">71</span>)</code></pre></div>
<p>We will need to exclude cases with missing data for the outcome. Work with the <code>nhefs_subs</code> for the remainder of this analysis:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nhefs_subs &lt;-<span class="st"> </span>nhefs <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(wt82_<span class="dv">71</span>))</code></pre></div>
<p>Let’s look at the variable distributions within the treated (<code>qsmk = 1</code>: the quitters) and the untreated (<code>qsmk = 0</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Here we enumerate the quantitative and the categorical variables</span>
quant_vars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;alcoholhowmuch&quot;</span>, <span class="st">&quot;cholesterol&quot;</span>, <span class="st">&quot;ht&quot;</span>, <span class="st">&quot;pregnancies&quot;</span>, <span class="st">&quot;price71&quot;</span>, <span class="st">&quot;smokeintensity&quot;</span>, <span class="st">&quot;smokeyrs&quot;</span>, <span class="st">&quot;tax71&quot;</span>, <span class="st">&quot;wt71&quot;</span>)

categ_vars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;active&quot;</span>, <span class="st">&quot;alcoholfreq&quot;</span>, <span class="st">&quot;alcoholpy&quot;</span>, <span class="st">&quot;alcoholtype&quot;</span>, <span class="st">&quot;allergies&quot;</span>, <span class="st">&quot;asthma&quot;</span>, <span class="st">&quot;boweltrouble&quot;</span>, <span class="st">&quot;bronch&quot;</span>, <span class="st">&quot;chroniccough&quot;</span>, <span class="st">&quot;colitis&quot;</span>, <span class="st">&quot;diabetes&quot;</span>, <span class="st">&quot;education&quot;</span>, <span class="st">&quot;exercise&quot;</span>, <span class="st">&quot;hayfever&quot;</span>, <span class="st">&quot;hbp&quot;</span>, <span class="st">&quot;hbpmed&quot;</span>, <span class="st">&quot;headache&quot;</span>, <span class="st">&quot;hepatitis&quot;</span>, <span class="st">&quot;hf&quot;</span>, <span class="st">&quot;hightax82&quot;</span>, <span class="st">&quot;income&quot;</span>, <span class="st">&quot;infection&quot;</span>, <span class="st">&quot;lackpep&quot;</span>, <span class="st">&quot;marital&quot;</span>, <span class="st">&quot;nerves&quot;</span>, <span class="st">&quot;nervousbreak&quot;</span>, <span class="st">&quot;otherpain&quot;</span>, <span class="st">&quot;pepticulcer&quot;</span>, <span class="st">&quot;pica&quot;</span>, <span class="st">&quot;polio&quot;</span>, <span class="st">&quot;race&quot;</span>, <span class="st">&quot;school&quot;</span>, <span class="st">&quot;sex&quot;</span>, <span class="st">&quot;tb&quot;</span>, <span class="st">&quot;tumor&quot;</span>, <span class="st">&quot;weakheart&quot;</span>, <span class="st">&quot;wtloss&quot;</span>)

<span class="co"># Compare the means of the quantitative variables in the treated and untreated</span>
nhefs_subs <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(qsmk) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarize_at</span>(<span class="dt">.vars =</span> quant_vars, <span class="dt">.funs =</span> mean) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">as.data.frame</span>()

<span class="co"># Compare the distributions of the categorical variables in the treated and untreated</span>
<span class="co"># First row numbers are P(covariate | qsmk=0)</span>
<span class="co"># Second row numbers are P(covariate | qsmk=1)</span>
<span class="cf">for</span> (c_var <span class="cf">in</span> categ_vars) {
    <span class="kw">cat</span>(c_var, <span class="st">&quot;:</span><span class="ch">\n</span><span class="st">&quot;</span>)
    <span class="kw">table</span>(<span class="dt">qsmk =</span> nhefs_subs<span class="op">$</span>qsmk, nhefs_subs[[c_var]], <span class="dt">useNA =</span> <span class="st">&quot;ifany&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">prop.table</span>(<span class="dt">margin =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">print</span>()
    <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
}</code></pre></div>
<p>How could you use these data summaries to help with DAG construction (coming next)?</p>
<p><br><br><br></p>
<p><strong>Part 2: Causal DAG construction</strong></p>
<p>Building the causal DAG from start to finish would normally be a much longer process. So that we can get to the data analysis practice, we’ll abbreviate this crucial step. We’ll start with the following d-separating set:</p>
<ul>
<li><code>sex</code></li>
<li><code>age</code></li>
<li><code>race</code></li>
<li><code>education</code></li>
<li><code>smokeintensity</code></li>
<li><code>smokeyrs</code></li>
<li><code>active</code></li>
<li><code>exercise</code></li>
<li><code>wt71</code></li>
</ul>
<p>Open up the <a href="http://www.dagitty.net/dags.html">web version</a> of <a href="http://www.dagitty.net/">DAGitty</a>, which we’ll use to draw our causal diagram.</p>
<ul>
<li>In the top menu bar, click “Model” &gt; “New model”.</li>
<li>Also go through the “How to …”</li>
<li>Add the treatment and outcome nodes as well as the above variables. Also add the relevant edges.</li>
<li>Looking briefly through the codebook and your data summaries above, do you think that there are other key variables to include in the DAG?</li>
<li>There is potential selection bias at play. (There were missing values for the response variable.) Add a selection node and give it the “adjusted” status (under the left “Variable” menu). What factors do you think are related to not showing up for the second study visit (and thus not having weight gain measured)? Based on this add edges between the selection node and other variables.</li>
<li>What is your d-separating set?</li>
</ul>
<p>So that you can come back to your DAG easily, copy and paste the “Model code” in the right side menu into a separate text document.</p>
<p><br><br><br></p>
<p><strong>Part 3: Propensity score modeling</strong></p>
<p>In order to fit marginal structural models (MSMs) that allow us to estimate average causal effects, we need to estimate the propensity scores.</p>
<p>Make visualizations to inform the nature of the relationship between treatment and the quantitative predictors. For example, you can use code like the following to see if the observed probabilities (in blue) match up with those predicted by a logistic regression model with a quadratic function of age (in red). The <code>y~poly(x,2)</code> could be changed to <code>y~x</code> to see the results of having <code>age</code> linearly related to the log odds of treatment.</p>
<p>State your conclusions from these visualizations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(nhefs, <span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> qsmk)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">formula =</span> y<span class="op">~</span><span class="kw">poly</span>(x,<span class="dv">2</span>), <span class="dt">method=</span><span class="st">&quot;glm&quot;</span>, <span class="dt">method.args=</span><span class="kw">list</span>(<span class="dt">family=</span><span class="st">&quot;binomial&quot;</span>), <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p>Based on your visualizations, construct an appropriate propensity score model. To include polynomial relationships in the model you can use <code>+poly(age, 2)</code>, for example, in the model formula.</p>
<p>Compute the estimated propensity scores and inverse probability weights as we did in our simulations. Call the weight variable <code>weight1</code>. Here you’ll want to check if <code>nhefs_subs$qsmk==1</code> or <code>nhefs_subs$qsmk==0</code>. Store the IP weights in your <code>nhefs_subs</code> dataset.</p>
<p><br><br><br></p>
<p><strong>Part 4: Fitting marginal structural models</strong></p>
<p>Install the <code>geepack</code> package which we’ll be using to fit MSMs. This package fits linear and logistic regression models like <code>lm()</code> and <code>glm()</code> do, but it uses a better estimate of the standard error in the presence of weights.</p>
<p>The code below fits the MSM:</p>
<p><span class="math display">\[ E[Y^a] = \beta_0 + \beta_1 \hbox{qsmk} \]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(geepack)
msm_fit1 &lt;-<span class="st"> </span><span class="kw">geeglm</span>(
    wt82_<span class="dv">71</span> <span class="op">~</span><span class="st"> </span>qsmk,
    <span class="dt">data =</span> nhefs_subs,
    <span class="dt">weights =</span> weight1,
    <span class="dt">id =</span> seqn,
    <span class="dt">corstr =</span> <span class="st">&quot;independence&quot;</span>
)
<span class="kw">summary</span>(msm_fit1)</code></pre></div>
<ul>
<li>Interpret both the intercept and <code>qsmk</code> coefficients.</li>
<li>Confidence intervals are not displayed in the output, so we’ll compute them by hand. (p-values are displayed, but it’ll be nice to have confidence intervals because they nicely convey both the estimate itself and its uncertainty.) The coefficient estimates are expected to be normally distributed with mean equal to the true population value and standard deviation equal to the standard error. Use the <code>qnorm()</code> function to obtain the 95% confidence interval for the <code>qsmk</code> coefficient.</li>
<li>Summarize your results from this analysis.</li>
</ul>
<p>Adapt the above code to fit an effect modification MSM:</p>
<p><span class="math display">\[ E[Y^a] = \beta_0 + \beta_1\,\hbox{qsmk} + \beta_2\,\hbox{sex} + \beta_3\,\hbox{qsmk}\times \hbox{sex} \]</span></p>
<p>Interpret both the <code>qsmk</code> and interaction coefficients. Compute confidence intervals for those coefficients, and summarize your results.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="estimating-causal-effects.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ip-weighting-for-censoring.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
