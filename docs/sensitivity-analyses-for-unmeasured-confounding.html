<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic 9 Sensitivity Analyses for Unmeasured Confounding | STAT 394: Causal Inference</title>
  <meta name="description" content="This is the class website for Causal Inference at Macalester College." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic 9 Sensitivity Analyses for Unmeasured Confounding | STAT 394: Causal Inference" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the class website for Causal Inference at Macalester College." />
  <meta name="github-repo" content="lmyint/causal_spring_2020" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic 9 Sensitivity Analyses for Unmeasured Confounding | STAT 394: Causal Inference" />
  
  <meta name="twitter:description" content="This is the class website for Causal Inference at Macalester College." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="causal-discovery.html"/>
<link rel="next" href="homework-1.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #2a211c; color: #bdae9d; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; background-color: #2a211c; color: #bdae9d; border-right: 1px solid #bdae9d; }
td.sourceCode { padding-left: 5px; }
pre, code { color: #bdae9d; background-color: #2a211c; }
code > span.kw { color: #43a8ed; font-weight: bold; } /* Keyword */
code > span.dt { text-decoration: underline; } /* DataType */
code > span.dv { color: #44aa43; } /* DecVal */
code > span.bn { color: #44aa43; } /* BaseN */
code > span.fl { color: #44aa43; } /* Float */
code > span.ch { color: #049b0a; } /* Char */
code > span.st { color: #049b0a; } /* String */
code > span.co { color: #0066ff; font-style: italic; } /* Comment */
code > span.al { color: #ffff00; } /* Alert */
code > span.fu { color: #ff9358; font-weight: bold; } /* Function */
code > span.er { color: #ffff00; font-weight: bold; } /* Error */
code > span.wa { color: #ffff00; font-weight: bold; } /* Warning */
code > span.cn { } /* Constant */
code > span.sc { color: #049b0a; } /* SpecialChar */
code > span.vs { color: #049b0a; } /* VerbatimString */
code > span.ss { color: #049b0a; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { color: #43a8ed; font-weight: bold; } /* ControlFlow */
code > span.op { } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { font-weight: bold; } /* Preprocessor */
code > span.at { } /* Attribute */
code > span.do { color: #0066ff; font-style: italic; } /* Documentation */
code > span.an { color: #0066ff; font-weight: bold; font-style: italic; } /* Annotation */
code > span.co { color: #0066ff; font-weight: bold; font-style: italic; } /* Comment */
code > span.in { color: #0066ff; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="custom_styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href = "./">STAT 394: Causal Inference</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html"><i class="fa fa-check"></i>Schedule</a><ul>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html#week-1"><i class="fa fa-check"></i>Week 1</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html#week-2"><i class="fa fa-check"></i>Week 2</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html#week-3"><i class="fa fa-check"></i>Week 3</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html#week-4"><i class="fa fa-check"></i>Week 4</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html#week-5"><i class="fa fa-check"></i>Week 5</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html#week-6"><i class="fa fa-check"></i>Week 6</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html#week-7"><i class="fa fa-check"></i>Week 7</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html#week-8"><i class="fa fa-check"></i>Week 8</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html#spring-break-316---327"><i class="fa fa-check"></i>Spring Break: 3/16 - 3/27</a></li>
<li class="chapter" data-level="" data-path="schedule.html"><a href="schedule.html#week-9-330---43"><i class="fa fa-check"></i>Week 9: 3/30 - 4/3</a></li>
</ul></li>
<li class="part"><span><b>I Causal Diagram Fundamentals</b></span></li>
<li class="chapter" data-level="1" data-path="introductions-review-and-motivation.html"><a href="introductions-review-and-motivation.html"><i class="fa fa-check"></i><b>1</b> Introductions, Review, and Motivation</a><ul>
<li class="chapter" data-level="" data-path="introductions-review-and-motivation.html"><a href="introductions-review-and-motivation.html#learning-goals"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="introductions-review-and-motivation.html"><a href="introductions-review-and-motivation.html#review-regression-models"><i class="fa fa-check"></i>Review: Regression Models</a></li>
<li class="chapter" data-level="" data-path="introductions-review-and-motivation.html"><a href="introductions-review-and-motivation.html#exercises"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="introductions-review-and-motivation.html"><a href="introductions-review-and-motivation.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="introductions-review-and-motivation.html"><a href="introductions-review-and-motivation.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="introductions-review-and-motivation.html"><a href="introductions-review-and-motivation.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="probability-and-dags.html"><a href="probability-and-dags.html"><i class="fa fa-check"></i><b>2</b> Probability and DAGs</a><ul>
<li class="chapter" data-level="" data-path="probability-and-dags.html"><a href="probability-and-dags.html#learning-goals-1"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="probability-and-dags.html"><a href="probability-and-dags.html#goal-1"><i class="fa fa-check"></i>Goal 1</a></li>
<li class="chapter" data-level="" data-path="probability-and-dags.html"><a href="probability-and-dags.html#lead-in-to-r-activity-poll"><i class="fa fa-check"></i>Lead-in to R activity: Poll</a></li>
<li class="chapter" data-level="" data-path="probability-and-dags.html"><a href="probability-and-dags.html#discussion"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="probability-and-dags.html"><a href="probability-and-dags.html#r-exercises"><i class="fa fa-check"></i>R Exercises</a><ul>
<li class="chapter" data-level="" data-path="probability-and-dags.html"><a href="probability-and-dags.html#exercise-1-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="probability-and-dags.html"><a href="probability-and-dags.html#exercise-2-1"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="probability-and-dags.html"><a href="probability-and-dags.html#exercise-3-1"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probability-and-dags.html"><a href="probability-and-dags.html#conceptual-exercises"><i class="fa fa-check"></i>Conceptual Exercises</a><ul>
<li class="chapter" data-level="" data-path="probability-and-dags.html"><a href="probability-and-dags.html#exercise-4"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="probability-and-dags.html"><a href="probability-and-dags.html#exercise-5"><i class="fa fa-check"></i>Exercise 5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="d-separation-part-1.html"><a href="d-separation-part-1.html"><i class="fa fa-check"></i><b>3</b> d-separation (Part 1)</a><ul>
<li class="chapter" data-level="" data-path="d-separation-part-1.html"><a href="d-separation-part-1.html#learning-goals-2"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="d-separation-part-1.html"><a href="d-separation-part-1.html#discussion-d-separation"><i class="fa fa-check"></i>Discussion: d-separation</a></li>
<li class="chapter" data-level="" data-path="d-separation-part-1.html"><a href="d-separation-part-1.html#discussion-the-birth-weight-paradox"><i class="fa fa-check"></i>Discussion: The Birth Weight Paradox</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="d-separation-part-2.html"><a href="d-separation-part-2.html"><i class="fa fa-check"></i><b>4</b> d-separation (Part 2)</a><ul>
<li class="chapter" data-level="" data-path="d-separation-part-2.html"><a href="d-separation-part-2.html#learning-goals-3"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="d-separation-part-2.html"><a href="d-separation-part-2.html#why-care"><i class="fa fa-check"></i>Why care?</a></li>
<li class="chapter" data-level="" data-path="d-separation-part-2.html"><a href="d-separation-part-2.html#example-folic-acid-and-birth-defects"><i class="fa fa-check"></i>Example: Folic Acid and Birth Defects</a></li>
<li class="chapter" data-level="" data-path="d-separation-part-2.html"><a href="d-separation-part-2.html#example-selection-bias"><i class="fa fa-check"></i>Example: Selection Bias</a></li>
<li class="chapter" data-level="" data-path="d-separation-part-2.html"><a href="d-separation-part-2.html#example-estrogens-and-uterine-cancer"><i class="fa fa-check"></i>Example: Estrogens and Uterine Cancer</a></li>
<li class="chapter" data-level="" data-path="d-separation-part-2.html"><a href="d-separation-part-2.html#principles-of-building-causal-diagrams"><i class="fa fa-check"></i>Principles of building causal diagrams</a></li>
</ul></li>
<li class="part"><span><b>II Causal Effect Estimation</b></span></li>
<li class="chapter" data-level="5" data-path="estimating-causal-effects.html"><a href="estimating-causal-effects.html"><i class="fa fa-check"></i><b>5</b> Estimating causal effects</a><ul>
<li class="chapter" data-level="" data-path="estimating-causal-effects.html"><a href="estimating-causal-effects.html#learning-goals-4"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="estimating-causal-effects.html"><a href="estimating-causal-effects.html#exercise-dag-construction"><i class="fa fa-check"></i>Exercise: DAG construction</a></li>
<li class="chapter" data-level="" data-path="estimating-causal-effects.html"><a href="estimating-causal-effects.html#warm-up-d-separation"><i class="fa fa-check"></i>Warm-up: d-separation</a></li>
<li class="chapter" data-level="" data-path="estimating-causal-effects.html"><a href="estimating-causal-effects.html#discussion-estimating-causal-effects"><i class="fa fa-check"></i>Discussion: Estimating causal effects</a><ul>
<li class="chapter" data-level="" data-path="estimating-causal-effects.html"><a href="estimating-causal-effects.html#worksheet-developing-ideas"><i class="fa fa-check"></i>Worksheet: developing ideas</a></li>
<li class="chapter" data-level="" data-path="estimating-causal-effects.html"><a href="estimating-causal-effects.html#notes-deriving-inverse-probability-weighting"><i class="fa fa-check"></i>Notes: deriving inverse probability weighting</a></li>
<li class="chapter" data-level="" data-path="estimating-causal-effects.html"><a href="estimating-causal-effects.html#exercise-simulation-planning"><i class="fa fa-check"></i>Exercise: Simulation planning</a></li>
<li class="chapter" data-level="" data-path="estimating-causal-effects.html"><a href="estimating-causal-effects.html#simulation-example"><i class="fa fa-check"></i>Simulation example</a></li>
<li class="chapter" data-level="" data-path="estimating-causal-effects.html"><a href="estimating-causal-effects.html#on-your-own"><i class="fa fa-check"></i>On your own</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ip-weighting-in-practice.html"><a href="ip-weighting-in-practice.html"><i class="fa fa-check"></i><b>6</b> IP weighting in practice</a><ul>
<li class="chapter" data-level="" data-path="ip-weighting-in-practice.html"><a href="ip-weighting-in-practice.html#learning-goals-5"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="ip-weighting-in-practice.html"><a href="ip-weighting-in-practice.html#discussion-1"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="ip-weighting-in-practice.html"><a href="ip-weighting-in-practice.html#analysis"><i class="fa fa-check"></i>Analysis</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ip-weighting-for-censoring.html"><a href="ip-weighting-for-censoring.html"><i class="fa fa-check"></i><b>7</b> IP weighting for censoring</a><ul>
<li class="chapter" data-level="" data-path="ip-weighting-for-censoring.html"><a href="ip-weighting-for-censoring.html#learning-goals-6"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="ip-weighting-for-censoring.html"><a href="ip-weighting-for-censoring.html#discussion-2"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="ip-weighting-for-censoring.html"><a href="ip-weighting-for-censoring.html#exercises-1"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="ip-weighting-for-censoring.html"><a href="ip-weighting-for-censoring.html#setup"><i class="fa fa-check"></i>Setup</a></li>
<li class="chapter" data-level="" data-path="ip-weighting-for-censoring.html"><a href="ip-weighting-for-censoring.html#part-1-modeling-to-obtain-weights"><i class="fa fa-check"></i>Part 1: Modeling to obtain weights</a></li>
<li class="chapter" data-level="" data-path="ip-weighting-for-censoring.html"><a href="ip-weighting-for-censoring.html#part-2-fitting-msms"><i class="fa fa-check"></i>Part 2: Fitting MSMs</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Causal Discovery</b></span></li>
<li class="chapter" data-level="8" data-path="causal-discovery.html"><a href="causal-discovery.html"><i class="fa fa-check"></i><b>8</b> Causal Discovery</a><ul>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#learning-goals-7"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#discussion-3"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercises-2"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-1-2"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-2-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-3-2"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-4-1"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-5-1"><i class="fa fa-check"></i>Exercise 5</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-6"><i class="fa fa-check"></i>Exercise 6</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-7"><i class="fa fa-check"></i>Exercise 7</a></li>
<li class="chapter" data-level="" data-path="causal-discovery.html"><a href="causal-discovery.html#exercise-8"><i class="fa fa-check"></i>Exercise 8</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Sensitivity Analyses</b></span></li>
<li class="chapter" data-level="9" data-path="sensitivity-analyses-for-unmeasured-confounding.html"><a href="sensitivity-analyses-for-unmeasured-confounding.html"><i class="fa fa-check"></i><b>9</b> Sensitivity Analyses for Unmeasured Confounding</a><ul>
<li class="chapter" data-level="" data-path="sensitivity-analyses-for-unmeasured-confounding.html"><a href="sensitivity-analyses-for-unmeasured-confounding.html#learning-goals-8"><i class="fa fa-check"></i>Learning Goals</a></li>
<li class="chapter" data-level="" data-path="sensitivity-analyses-for-unmeasured-confounding.html"><a href="sensitivity-analyses-for-unmeasured-confounding.html#exercises-3"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="part"><span><b>V Homework</b></span></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html"><i class="fa fa-check"></i>Homework 1</a><ul>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#conceptual-exercises-1"><i class="fa fa-check"></i>Conceptual Exercises</a><ul>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#exercise-1-3"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#exercise-2-3"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#exercise-3-3"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#simulation-exercises"><i class="fa fa-check"></i>Simulation Exercises</a><ul>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#exercise-4-2"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#exercise-5-2"><i class="fa fa-check"></i>Exercise 5</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#exercise-6-1"><i class="fa fa-check"></i>Exercise 6</a></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#exercise-7-1"><i class="fa fa-check"></i>Exercise 7</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-1.html"><a href="homework-1.html#portfolio"><i class="fa fa-check"></i>Portfolio</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html"><i class="fa fa-check"></i>Homework 2</a><ul>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#in-class-activities-estimating-causal-effects"><i class="fa fa-check"></i>In-class activities: Estimating causal effects</a></li>
<li class="chapter" data-level="" data-path="homework-2.html"><a href="homework-2.html#in-class-activities-ip-weighting-in-practice"><i class="fa fa-check"></i>In-class activities: IP weighting in practice</a></li>
</ul></li>
<li class="part"><span><b>VI Projects</b></span></li>
<li class="chapter" data-level="" data-path="portfolio-1.html"><a href="portfolio-1.html"><i class="fa fa-check"></i>Portfolio</a><ul>
<li class="chapter" data-level="" data-path="portfolio-1.html"><a href="portfolio-1.html#required-topics"><i class="fa fa-check"></i>Required Topics</a></li>
<li class="chapter" data-level="" data-path="portfolio-1.html"><a href="portfolio-1.html#iterative-progress"><i class="fa fa-check"></i>Iterative Progress</a></li>
<li class="chapter" data-level="" data-path="portfolio-1.html"><a href="portfolio-1.html#building-a-personal-website"><i class="fa fa-check"></i>Building a Personal Website</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STAT 394: Causal Inference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sensitivity-analyses-for-unmeasured-confounding" class="section level1">
<h1><span class="header-section-number">Topic 9</span> Sensitivity Analyses for Unmeasured Confounding</h1>
<div id="learning-goals-8" class="section level2 unnumbered">
<h2>Learning Goals</h2>
<ol style="list-style-type: decimal">
<li>Understand the role of sensitivity analyses in sound scientific practice</li>
<li>Implement and interpret the results of sensitivity analyses</li>
</ol>
<p><br><br></p>
</div>
<div id="exercises-3" class="section level2 unnumbered">
<h2>Exercises</h2>
<p>A template Rmd is available <a href="template_rmds/09-sensitivity.Rmd">here</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(geepack)</code></pre></div>
<p>Given the code below, what is the underlying DAG?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">302</span>)
n &lt;-<span class="st"> </span><span class="dv">5000</span>
Z &lt;-<span class="st"> </span><span class="kw">rbinom</span>(n, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="fl">0.5</span>)
p_A &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">case_when</span>(
    Z<span class="op">==</span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="fl">0.6</span>,
    Z<span class="op">==</span><span class="dv">0</span> <span class="op">~</span><span class="st"> </span><span class="fl">0.2</span>
)
A &lt;-<span class="st"> </span><span class="kw">rbinom</span>(n, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> p_A)
Y &lt;-<span class="st"> </span><span class="fl">0.1</span><span class="op">*</span>A <span class="op">+</span><span class="st"> </span><span class="fl">0.3</span><span class="op">*</span>Z <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n)

sim_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(A, Y, Z)

<span class="co"># Create a subject ID variable</span>
sim_data<span class="op">$</span>subj_id &lt;-<span class="st"> </span><span class="kw">seq_len</span>(n)</code></pre></div>
<p>First <em>outline</em> the process for fitting a marginal structural model to estimate the average causal effect of treatment <span class="math inline">\(A\)</span> on outcome <span class="math inline">\(Y\)</span>. Then write the relevant code. You will need to use <code>subj_id</code> as the <code>id</code> variable within <code>geeglm()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Original MSM fit</span></code></pre></div>
<p>Here we begin our sensitivity analysis. We’ll create a binary unmeasured variable <span class="math inline">\(U\)</span> that has varying degrees of association with both <span class="math inline">\(A\)</span> and <span class="math inline">\(Y\)</span>.</p>
<ul>
<li>Add extra comments throughout the code to better document this implementation of a sensitivity analysis.</li>
<li>Complete the sensitivity analysis by completing the <code>TASK</code> referred to within the for-loop.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create a vector of possible associations that U has with A and Y</span>
U_assocs &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.05</span>,<span class="dv">2</span>,<span class="fl">0.1</span>)

<span class="co"># Create empty storage containers to store the new ACEs and CI bounds</span>
new_aces &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">length</span>(U_assocs))
new_ci_upper &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">length</span>(U_assocs))
new_ci_lower &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">length</span>(U_assocs))

<span class="co"># Loop over possible values of the association</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(U_assocs)) {
    U_assoc &lt;-<span class="st"> </span>U_assocs[i]
    log_odds_U &lt;-<span class="st"> </span>U_assoc<span class="op">*</span>sim_data<span class="op">$</span>Y <span class="op">+</span><span class="st"> </span>U_assoc<span class="op">*</span>sim_data<span class="op">$</span>A
    p_U &lt;-<span class="st"> </span><span class="kw">exp</span>(log_odds_U)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span><span class="kw">exp</span>(log_odds_U))
    U &lt;-<span class="st"> </span><span class="kw">rbinom</span>(n, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> p_U)
    sim_data<span class="op">$</span>U &lt;-<span class="st"> </span>U

    <span class="co"># </span><span class="al">TASK</span><span class="co">: Fit the new MSM that accounts for U</span>
    new_msm_fit &lt;-<span class="st"> </span>???

    <span class="co"># Store relevant values</span>
    new_aces[i] &lt;-<span class="st"> </span><span class="kw">summary</span>(new_msm_fit)<span class="op">$</span>coefficients[<span class="st">&quot;A&quot;</span>, <span class="st">&quot;Estimate&quot;</span>]
    se &lt;-<span class="st"> </span><span class="kw">summary</span>(new_msm_fit)<span class="op">$</span>coefficients[<span class="st">&quot;A&quot;</span>, <span class="st">&quot;Std.err&quot;</span>]
    new_ci_upper[i] &lt;-<span class="st"> </span>new_aces[i]<span class="op">+</span>(<span class="kw">qnorm</span>(<span class="fl">0.975</span>)<span class="op">*</span>se)
    new_ci_lower[i] &lt;-<span class="st"> </span>new_aces[i]<span class="op">-</span>(<span class="kw">qnorm</span>(<span class="fl">0.975</span>)<span class="op">*</span>se)
}</code></pre></div>
<p>Below we plot the results of this sensitivity analysis. The black line shows the different ACEs, and the ribbon shows the corresponding 95% confidence interval. The red line shows the original ACE estimate.</p>
<ul>
<li>What information can be gained from this plot?</li>
<li>What is the smallest magnitude of association with <span class="math inline">\(U\)</span> that leads to qualitatively different conclusions?</li>
<li>Look back to where we simulated <span class="math inline">\(Y\)</span>. How could we change this so that the smallest magnitude referred to in the previous question is bigger?</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sens_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">lnOR =</span> U_assocs, <span class="dt">ace =</span> new_aces, <span class="dt">ci_lower =</span> new_ci_lower, <span class="dt">ci_upper =</span> new_ci_upper)
<span class="kw">ggplot</span>(sens_data, <span class="kw">aes</span>(<span class="dt">x =</span> lnOR, <span class="dt">y =</span> ace)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> ci_lower, <span class="dt">ymax =</span> ci_upper), <span class="dt">fill =</span> <span class="st">&quot;grey70&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="kw">summary</span>(orig_msm_fit)<span class="op">$</span>coefficients[<span class="st">&quot;A&quot;</span>, <span class="st">&quot;Estimate&quot;</span>]), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><strong>Closing questions:</strong> How could we adapt this structure for a sensitivity analysis to situations where the variables under consideration are of different types (quantitative vs. categorical) than what we considered here? How could these sensitivity analyses be used for assessing the impact of even more general structures of unmeasured confounding?</p>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="causal-discovery.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="homework-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
