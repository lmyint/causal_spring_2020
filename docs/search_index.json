[
["index.html", "STAT 394: Causal Inference Welcome!", " STAT 394: Causal Inference Welcome! Image source: IMDB. (Know how this relates to class? Tell the instructor!) This is the course website for STAT 394: Causal Inference at Macalester College for the Spring 2020 semester. The content here was made by Leslie Myint and draws upon several resources, all of which are listed on the References page. This work is licensed under a Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License. "],
["references.html", "References", " References The material for this course draws from the following list of excellent resources. Required references (download these!): Causal Inference in Statistics: A Primer, by Judea Pearl, Madelyn Glymour, and Nicholas P. Jewell. PDF freely available online. (Referred to as “PRIMER”.) Causal Inference: What If, by Miguel A. Hernán and James M. Robins. PDF freely available online. (Referred to as “WHATIF”.) Other materials: The Book of Why: The New Science of Cause and Effect, by Judea Pearl and Dana Mackenzie (Amazon) Causality: Models, Reasoning, and Inference, by Judea Pearl (available as an eBook through Macalester’s libarary) Materials from the course, Causal Inference in Medicine and Public Health, taught by Elizabeth Stuart at JHSPH edX course: Causal Diagrams: Draw Your Assumptions Before Your Conclusions Udemy course: Causal Data Science with Directed Acyclic Graphs "],
["schedule.html", "Schedule", " Schedule Week 1 Thursday, January 23 Introductions, review of key ideas from STAT 155, why we need causal stories (graphs!) Slides from class are available here. After class: Recommended reading: PRIMER, Chapter 1: Sections 1.1, 1.2 Required reading: PRIMER, Chapter 1: 1.4, 1.5.1 Week 2 Thursday, January 30 The mathematics (probability) of graphs Before class: Please watch the following two videos and/or read the corresponding sections of PRIMER. Answer the Moodle questions before class. Video 1: Essentials of Probability, (slides) Video 2: Key Structure in DAGs, (slides) Reading: PRIMER, Chapter 1: Sections 1.3.1 to 1.3.5, Chapter 2: Sections 2.1 to 2.3 Week 3 Tuesday, February 4 d-separation and its applications for understanding bias Before class: Reading: PRIMER, Chapter 2: Section 2.4. There is one associated Moodle question for this reading. Please also read the article The Birth Weight “Paradox” Uncovered? available in the Readings section on Moodle. We will discuss in class on Tuesday. Tuesday, February 4 d-separation and its applications for understanding bias (continued) No new reading. Work on Homework 1, due Thursday, February 13 in class. Week 4 Tuesday, February 11 The do-operator and estimating causal effects Before class: Required reading: PRIMER, Chapter 1: 1.3.6 and 1.3.7, Chapter 3: Sections 3.1 through 3.3 (skip 3.2.2 on Multiple Interventions). Answer the Moodle questions (under “The do-operator and estimating causal effects”) before class. Thursday, February 13 The do-operator and estimating causal effects (continued) "],
["introductions-review-and-motivation.html", "Topic 1 Introductions, Review, and Motivation Learning Goals Review: Regression Models Exercises", " Topic 1 Introductions, Review, and Motivation Slides from today are available here. Learning Goals Understand the instances in which we care about causation more than association Review regression modeling and develop some ideas about its relation to causal inference goals Develop some ideas for why causal stories (i.e., expert knowledge) are crucial for causal inference goals Review: Regression Models Discuss the following questions with your group members. What does a linear regression model formula look like? If you covered logistic regression in STAT 155, what does a logistic regression model formula look like? When would you use logistic vs. linear regression? In general, how do we interpret the intercept in a regression model (both linear and logistic)? How do we interpret the other coefficients in a regression model (both linear and logistic)? How can we justify this interpretation mathematically? How might regression models be useful in understanding the causal effect of some variable on an outcome? Exercises You can download a template RMarkdown file to start from here. We will look at (simulated) data from a study that looked at the effectiveness of chemotherapy for treating colon cancer. Chemotherapy is effectively a poison that kills cells in the body that are rapidly proliferating: these cells include the cancer cells (often in a mass called a tumor) but also cells in bone marrow involved in sustaining the immune system. In this study, researchers measured the following variables: pre_tumor_size: Tumor size before the chemotherapy/placebo treatment (Small or Large). treated: ChemoYes if the patient received chemotherapy or ChemoNo if not. post_tumor_size: Tumor size 3 months after the chemotherapy/placebo treatment (Small or Large). recovery: Yes if the patient recovered from their cancer. No otherwise. You can read in the data as follows: chemo_study_data &lt;- read.csv(&quot;https://www.dropbox.com/s/vl06j75a8afw8ct/chemo_study.csv?dl=1&quot;) Exercise 1 The first step in any data analysis is to visualize your data. Let’s refamiliarize ourselves with the ggplot2 package in R. It may be helpful to have this ggplot2 cheat sheet open. Make sure to load the ggplot2 package by including library(ggplot2) at the top of your RMarkdown document. Look at the distribution of each of the 4 measured variables. What plot type is most appropriate for this type of variable? ggplot(chemo_study_data, aes(x = pre_tumor_size)) + ??? Is pre-treatment tumor size predictive of whether or not a patient received chemotherapy? Make a plot to assess this, and briefly state what conclusions can be drawn from the plot. (Hint: it will be helpful to look at the second page of the cheat sheet in the section labeled “Position Adjustments”.) ggplot(chemo_study_data, aes(x = pre_tumor_size, fill = treated)) + ??? Is pre-treatment tumor size predictive of whether or not a patient recovered? Make a plot, and briefly state your conclusions. A variable is a confounder if it is a common cause of both the treatment and outcome. This is shown in the diagram below. Given your results from parts b and c, could pre-treatment tumor size be a confounder of the relationship between chemotherapy treatment and recovery? If yes, what is the concern here? Note: the causal relationships of interest so far can be depicted in a causal diagram, shown below. An arrow between two variables indicates that one is a cause of the other (an arrow points from a cause to its effect). Exercise 2 One way to “adjust for” the influence of counfounders is to include them as predictors/explanatory variables in regression models. We can model recovery using a logistic regression model (used when the outcome variable is binary). In R, we can fit a logistic regression model using code like the following: # Fit the model and store it in the &quot;mod&quot; object mod &lt;- glm(outcome_variable ~ explanatory_variable1+explanatory_variable2, family = &quot;binomial&quot;, data = your_data) # Display model output summary(mod) Fit a logistic regression model with only treatment as a predictor. Interpret the treatment coefficient. Is this the interpretation you expected? Fit a logistic regression model with both treatment and pre-treatment tumor size as predictors. Interpret the treatment coefficient. Is this the interpretation you expected? Exercise 3 So far, we have not considered the post_tumor_size variable at all in our analyses. Let’s get some visual understanding of this variable. Make 2 plots: one showing its relationship with the treated variable and the second showing its relationship with the recovery variable. What is your intuition - should we include post_tumor_size as an explanatory variable in our logistic regression model? Why or why not? Fit the logistic regression model (mod3) with all 3 explanatory variables, and interpret the treatment coefficient. How do the results compare to mod2? The diagram that we considered at the end of Exercise 1 only included the treatment, recovery, and pre-treatment tumor size variables. Draw (on paper) an expanded causal diagram that includes post-treatment tumor size. In light of where post-treatment tumor size appears on your diagram, what does it mean to include it in the logistic regression model? The data in this investigation were simulated. That is, your instructor generated them, and thus, she actually knows the truth behind the data. The truth is that chemotherapy does have a true beneficial causal impact on recovery. Chemotherapy does increases the chance of recovery. Given this information and the insights you gained from these three exercises, try to put all of this information together. What makes sense? What remains unclear? "],
["probability-and-dags.html", "Topic 2 Probability and DAGs Learning Goals Goal 1 Lead-in to R activity: Poll Discussion R Exercises Conceptual Exercises", " Topic 2 Probability and DAGs Learning Goals Appreciate the importance of starting analysis from prior/expert knowledge Simulate data corresponding to a causal DAG Use simulations to verify the marginal/conditional independence and dependence relationships implied by DAG structures Develop notions of causal and non-causal associations in the context of graphs Goal 1 In your groups, discuss your responses to the pre-class question about the figure below (which came from this article from Nature Pediatric Research). What arrows do all of you agree on? Do you disagree on any arrows? If the question of interest is how screen time affects the risk of childhood obesity, what variables and arrows do you think are missing? If you have time left, pick your favorite example of conditional independence and conditional dependence from your answers to the pre-class questions. Lead-in to R activity: Poll Navigate to: PollEv.com/lesliemyint417 Discussion Download this Rmd file to start from. library(ggplot2) library(dplyr) An introduction to the rbinom function: # 4 different people each flip a fair coin once rbinom(4, size = 1, prob = 0.5) # 4 different people flip loaded coins # First 2 flip a coin with P(Heads) = 0.9 # Second 2 flip a coin with P(Heads) = 0.2 rbinom(4, size = 1, prob = c(0.9, 0.9, 0.2, 0.2)) # Before you run this code, what will the result be? rbinom(2, size = 1, prob = c(1, 0)) How can we simulate X -&gt; Y for binary X and Y? # set.seed() ensures reproducible random numbers set.seed(2020) # Set sample size n &lt;- 1e5 # Generate a binary variable X for all n cases X &lt;- rbinom(n, size = 1, prob = 0.5) Y &lt;- rbinom(n, size = 1, prob = 0.5) Are the X and Y we just simulated independent or dependent? Let’s make a plot to see: # We put X and Y in a dataset using data.frame() # They are turned into categorical variables using factor() sim_data &lt;- data.frame(X = factor(X), Y = factor(Y)) # Proportional bar plot ggplot(sim_data, aes(x = X, fill = Y)) + geom_bar(position = &quot;fill&quot;) How can we make Y dependent on X? # Generate probabilities that Y=1 that depend on the value of X p_Y &lt;- dplyr::case_when( X==1 ~ 0.8, X==0 ~ 0.3 ) # Simulate Y using p_Y Y &lt;- rbinom(n, size = 1, prob = p_Y) # Put X, Y, and p_Y into a dataset sim_data &lt;- data.frame(X = factor(X), Y = factor(Y), p_Y = p_Y) # Check that p_Y = 0.8 when X is 1 sim_data %&gt;% filter(X==&quot;1&quot;) # Check that p_Y = 0.3 when X is 0 sim_data %&gt;% filter(X==&quot;0&quot;) # Proportional bar plot ggplot(sim_data, aes(x = X, fill = Y)) + geom_bar(position = &quot;fill&quot;) How can we make a variable Z dependent on 2 causes: X and Y? X &lt;- rbinom(n, size = 1, prob = 0.5) Y &lt;- rbinom(n, size = 1, prob = 0.5) p_Z &lt;- dplyr::case_when( X==1 &amp; Y==1 ~ 0.8, X==0 &amp; Y==1 ~ 0.3, X==1 &amp; Y==0 ~ 0.5, X==0 &amp; Y==0 ~ 0.9 ) Z &lt;- rbinom(n, size = 1, prob = p_Z) # Put X, Y, and Z into a dataset sim_data &lt;- data.frame(X = factor(X), Y = factor(Y), Z = factor(Z)) # If we wanted to save datasets filtered on Z (Why?) sim_data_filt_z0 &lt;- sim_data %&gt;% filter(Z==&quot;0&quot;) sim_data_filt_z1 &lt;- sim_data %&gt;% filter(Z==&quot;1&quot;) R Exercises Exercise 1 Simulate data for a chain X -&gt; Y -&gt; Z where all variables are binary. Make plots to show the following properties: X and Z are marginally dependent X and Z are conditionally independent given Y Describe how your simulation would change if you wanted to check the more general property of chains that two variables are conditionally independent given any variables in between them. (You don’t actually need to implement this simulation but can if you have time.) Exercise 2 Simulate data for a fork Y &lt;- X -&gt; Z where all variables are binary. Make plots to show the following properties: Y and Z are marginally dependent Y and Z are conditionally independent given X Exercise 3 Simulate data for a collider X -&gt; Z &lt;- Y where all variables are binary. Make plots to show the following properties: X and Y are marginally independent X and Y are conditionally dependent given Z Describe how your simulation would change if you wanted to check the more general property of colliders that X and Y become dependent conditional on Z and/or any descendants of Z. (You don’t actually need to implement this simulation but can if you have time.) Conceptual Exercises Exercise 4 In the causal diagram above, let X be a treament and Y be an outcome of interest. What would you say are the “causal paths” between X and Y? What would you say are the “non-causal paths”? Thinking about the marginal and conditional independence and dependence relations we’ve discussed, how might we restrict the influence of these non-causal paths? Exercise 5 Can you come up with a general rule that tells us when two variables will be conditionally independent given another set of variables Z? (Where it is possible that Z is an empty set containing no variables.) Try out your rule on the causal diagram below. "],
["d-separation-part-1.html", "Topic 3 d-separation (Part 1) Learning Goals Discussion: d-separation Discussion: The Birth Weight Paradox", " Topic 3 d-separation (Part 1) Learning Goals Review concepts of simulating DAGs in R Understand d-separation as a general means of identifying independence/dependence in arbitrarily complex causal diagrams Apply d-separation ideas to a case study: the birth weight paradox Discussion: d-separation A path \\(p\\) is blocked by a set of nodes \\(Z\\) (which could be the empty set) if and only if at least one of the two conditions below are met. (\\(Z\\) is the set of variables being conditioned on.) \\(p\\) contains a chain of nodes \\(A \\rightarrow B \\rightarrow C\\) or a fork \\(A \\leftarrow B \\rightarrow C\\) such that the middle node \\(B\\) is in \\(Z\\). \\(p\\) contains a collider \\(A \\rightarrow B \\leftarrow C\\) such that the collision node B is not in \\(Z\\), and no descendant of \\(B\\) is in \\(Z\\). If \\(Z\\) blocks every path between two nodes \\(X\\) and \\(Y\\), then \\(X\\) and \\(Y\\) are d-separated, conditional on \\(Z\\), and are thus independent conditional on \\(Z\\). Discussion: The Birth Weight Paradox To facilitate our discussion, key pieces of information and terminology from the article are summarized below. Crude mortality rate ratio \\[\\frac{\\hbox{Infant mortality rate for maternal smokers}}{\\hbox{Infant mortality rate for maternal non-smokers}} = 1.55\\] Adjusted mortality rate ratio: same ratio but arising from a logistic regression model in which birth weight was held constant. This was 1.09. Stratum-specific mortality rate ratios In low birth weight infants: \\[\\frac{\\hbox{Infant mortality rate for maternal smokers}}{\\hbox{Infant mortality rate for maternal non-smokers}} = 0.79\\] In normal birth weight infants: \\[\\frac{\\hbox{Infant mortality rate for maternal smokers}}{\\hbox{Infant mortality rate for maternal non-smokers}} = 1.80\\] In your groups, discuss the following questions. Make sure to take good notes because the first post in your Portfolio will be a careful analysis of this paper. Throughout, remember that looking only at low birth weight infants amounts to conditioning on that variable. Using our knowledge of (in)dependence relations in DAGs, explain this quote about Figure 3.1 from the paper: “Under this scenario, the crude mortality rate ratio for smoking would be greater than 1, whereas the adjusted rate ratio and, equivalently, the stratum-specific rate ratios should be 1.” Explain why Figure 3.2 implies that the crude and adjusted mortality rate ratios would be the same. In Figure 3.5, the authors do not include an arrow from Smoking to Mortality, but they use this diagram to explain how the birth weight paradox could arise. Why is excluding this arrow a key part of their argumentation? Using Figure 3.5, explain how the paradox arises by using the ideas of d-separation. Figure 3.7 is the most realistic of the causal diagrams. Explain how the paradox arises in this setting. In Figure 3.7, would the paradox have arisen if LBW-Type A had been the selection criterion instead of LBW? Would the paradox have arisen if LBW-Type B had been the selection criterion? Let’s generalize the key findings in this paper. The term selection bias broadly describes bias in results due to the way in which study participants are selected. How did selection bias come about for the birth weight paradox? Can we generalize this occurrence in terms of more general graph properties? "],
["d-separation-part-2.html", "Topic 4 d-separation (Part 2) Learning Goals Why care? Example: Folic Acid and Birth Defects Example: Selection Bias Example: Estrogens and Uterine Cancer Principles of building causal diagrams", " Topic 4 d-separation (Part 2) Learning Goals Practice d-separation ideas with more examples Why care? In adjusting for variables in our analysis, we want to “do no harm”: Block non-causal paths that generate unwanted associations Do not accidentally create non-causal paths that generate unwanted associations Leave causal paths (chains) alone Example: Folic Acid and Birth Defects Does maternal folic acid supplementation reduce the risk of birth defects? Or could associations be due to confounding factors? What should we adjust for in our analysis? Example: Selection Bias See handout! Example: Estrogens and Uterine Cancer Does postmenopausal estrogen supplementation (hormone replacement therapy) cause uterine cancer? Consistent association between estrogen use and uterine cancer was noticed in the 1970s Two hypotheses: Estrogens do cause cancer Estrogens don’t cause cancer but lead to uterine bleeding, leading to more frequent doctor visits, leading to increased diagnosis of existing cancer Proposal for a study: restrict the study only to those with uterine bleeding and compare cancer rates in estrogen-users and non-users In this way, all participants have the same chance of being diagnosed. What could be wrong about this approach? Can we design a better study? Causal diagrams corresponding to the two hypotheses: Work through the following questions in your groups: Consider the study proposal: restrict analysis to those with uterine bleeding. Argue that under DAG 1, estrogens and diagnosed cancer will be associated. Argue that under DAG 2, estrogens and diagnosed cancer will be associated. Thus conclude that this study proposal cannot distinguish between the two competing hypotheses. Consider another study proposal: ensure that everyone is screened frequently, and we don’t restrict our analysis to only those with uterine bleeding. What arrow (in either DAG 1 or 2) can be removed as a result of this study design? In this study, say that we don’t find an association between estrogens and diagnosed cancer? What does this mean about paths from estrogens to diagnosed cancer? In this study, say that we do find an association between estrogens and diagnosed cancer? What does this mean about paths from estrogens to diagnosed cancer? Based on these investigations, make a conclusion about the quality of this study proposal as compared to the first. Principles of building causal diagrams A DAG is a causal DAG if it is common cause-complete: for any two variables in the DAG, common causes (whether measured or unmeasured) of those variables are shown. A causal DAG does NOT to be cause-complete (infeasible due to infinite regress of causes). It should contain variables that are selected on, and subsequently common causes between those variables and existing variables. "],
["homework-1.html", "Homework 1 Conceptual Exercises Simulation Exercises Portfolio", " Homework 1 Due Thursday, February 13 in class Conceptual Exercises These exercises can be turned in on paper in class. Exercise 1 We have looked at 3 DAG structures (chains, forks, and colliders) and claimed that they are the building blocks of all DAGs. Is this true? We will verify this premise in this exercise. Let’s start by considering all possible directed (not necessarily acyclic) graphs with 3 variables. (Three is the smallest number of nodes where any interesting structures can arise.) There are 27 of these graphs. Draw all of these graphs with the aid of the expand.grid() function in R. First, look up the documentation for this function. Second, run the command below to get a sense for how the function can help you. For this part, display the 27 graphs, and provide a brief explanation of how expand.grid() helped. expand.grid( X_to_Y = c(&quot;-&gt;&quot;, &quot;&lt;-&quot;, &quot;absent&quot;), Y_to_Z = c(&quot;-&gt;&quot;, &quot;&lt;-&quot;, &quot;absent&quot;), X_to_Z = c(&quot;-&gt;&quot;, &quot;&lt;-&quot;, &quot;absent&quot;) ) From your list of graphs, indicate which graphs can be eliminated because they are cyclic. From your list of graphs, indicate which graphs can be eliminated because they are useless causal models. In your list of graphs, some graphs are essentially the same. Group these together, and draw one representative graph from each group. Briefly form a conclusion based on these investigations. Exercise 2 PRIMER, Study question 2.3.1: Parts (c), (e), and (f). For parts (e) and (f), explain your thinking. Exercise 3 PRIMER, Study question 2.4.1: Parts (a), (b), and (c). Simulation Exercises On Moodle, turn these exercises in by submitting both your Rmd file and the knitted HTML. For these exercises, ensure that your plots are well-labeled. Add the following to the ends of your plots to label your plots accurately: + labs(x = &quot;x axis label&quot;, y = &quot;y axis label&quot;, title = &quot;overall plot title&quot;) A refresher on facet_grid() that may be useful: To form panels across columns by variable Y: + facet_grid(~ Y) To form a grid of panels where rows correspond to X and columns to Y: + facet_grid(X ~ Y) To form a grid of panels where rows correspond to X and columns to Y and Z: + facet_grid(X ~ Y+Z) In case you’re curious about how to change the labeling of facet titles, see here. (Optional) You may or may not find it helpful/enjoyable to use the gridExtra package for arranging your plots. Example use case: library(gridExtra) p1 &lt;- ggplot(...) # Plot 1 p2 &lt;- ggplot(...) # Plot 2 p3 &lt;- ggplot(...) # Plot 3 p4 &lt;- ggplot(...) # Plot 4 # To arrange the 4 plots in a 2x2 grid: grid.arrange(p1, p2, p3, p4, ncol = 2, nrow = 2) If you look at your knitted HTML and think that your plots are too small, you can change the beginning of your code chunks to the following (playing with the numbers as needed): ```{r fig.width=12, fig.height=5} Exercise 4 Simulate data for a chain X -&gt; Y -&gt; Z where all variables are binary. Make plots to show the following properties: X and Z are marginally dependent X and Z are conditionally independent given Y Clearly explain how the plots show the dependence or independence. When you use dplyr::case_when() to generate probabilities that depend on another single variable, will any set of numbers work? Explain. Give an example of a set of numbers that would not generate the desired results. Exercise 5 Simulate data for a fork Y &lt;- X -&gt; Z where all variables are binary. Make plots to show the following properties: Y and Z are marginally dependent Y and Z are conditionally independent given X Exercise 6 Simulate data for a collider X -&gt; Z &lt;- Y where all variables are binary. Make plots to show the following properties: X and Y are marginally independent X and Y are conditionally dependent given Z When you use dplyr::case_when() to generate probabilities that depend on two variables, will any set of numbers work? Explain. Give an example of a set of numbers that would not generate the desired results. Exercise 7 Simulate data corresponding to the causal diagram in Figure 2.8 of PRIMER. Ignore the U variables (error terms) in the diagram, and treat all variables (T, Z, W, X, Y, and U) as binary. Make plots to show the following properties, and explain why they hold using the rules of d-separation: Z and Y are marginally dependent Z and Y are conditionally independent given T Z and Y are conditionally dependent given T and W Z and Y are conditionally independent given T, W, and X Portfolio Work on a draft post for required topic #1 (the birth weight paradox). "],
["portfolio-1.html", "Portfolio Required Topics Iterative Progress Building a Personal Website", " Portfolio Your portfolio is meant to be a well-written collection of documents about course topics. The hope is that this collection is a useful reference for yourself years down the line, but potentially it will be helpful for others who may happen across your material. Because of these goals, your portfolio will be a collection of blog posts. If you are keen on building your own website, you could publish these posts there as a part of building up an online presence. This is certainly not a requirement for class though. How you organize and structure your posts is up to you, but they need to address the topics below. Required Topics (This list will grow as the semester progresses.) An analysis of the article The Birth Weight “Paradox” Uncovered? at the level of detail of our in-class discussion. The post does not have to answer the exact same discussion questions posed in class. The post should explain the paradox and what the authors did to investigate it. This should include a discussion of how they proceeded through the various causal diagrams and why some were eliminated. The post should explain how the authors resolved the paradox in the most realistic causal diagrams. The post should conclude with general lessons learned from this example. Iterative Progress You will work on these posts iteratively throughout the semester. The homework assignments will give deadlines for when a rough draft is due. Although writing rough drafts will be part of your homework duties, the drafts will not be part of your homework grade. You will only receive qualitative feedback from me on your drafts. This will be the process for writing and feedback for the semester: Create one (and only one) new Google Doc. This will be where all of your drafts go. Enable link sharing so that those with the link can edit. Submit the link on Moodle &gt; Homework &gt; Portfolio Google Doc Link. Start writing! In the days after draft due dates, I will be reading your drafts and giving feedback by a fixed time. You are welcome to revise based on my feedback as many times as you want. When you would like another round of feedback, add a comment to the relevant section and tag me in it to bring it to my attention. (Type a “+” in the comment box followed by my email address.) Building a Personal Website If you are curious about building your own website, read on! First check out the instructor’s website. If you like the layout and want to try making a website using R (the blogdown package), read her blog post about setting up her website. "]
]
