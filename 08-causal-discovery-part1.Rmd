```{r 08_setup, include=FALSE}
knitr::opts_chunk$set(echo=TRUE, eval=FALSE)
```

# (PART) Causal Discovery {-}

# Causal Discovery (Part 1)

## Learning Goals {-}

1. Understand when causal discovery might be useful
2. Understand the ideas underlying causal discovery algorithms

<br><br>

## Discussion {-}

Slides are available [here](https://docs.google.com/presentation/d/1ckMGQ9YbjrUM5JCZ7EdNLrVfpS9pLYV0JUYMo9P0-xU/edit?usp=sharing).

<br><br>

## Exercises {-}

### Exercise 1 {-}

The SGS algorithm will find the correct equivalence class of graphs but is quite slow. We'll build up the ideas underlying a faster algorithm, the PC algorithm (stands for Peter-Clark).

a. Consider the testing of whether or not two variables are conditionally independent. How would you expect the computing time of this test to change as the variable set being conditioned on increases? Explain.

b. Recall the edge deletion step of SGS: For every pair of variables $X$ and $Y$ and all other sets $Z$ of other variables, check if we can make $X \perp \!\!\! \perp Y \mid Z$. If so, remove the edge between $X$ and $Y$.    
    - What strategies might we employ to make this step faster?
    - What might be a better order in which to 

c. What statistical advantages are linked to the better order you decided on in (b)? Think in terms of statistical power.

<br><br>

### Exercise 2 {-}

It'll be handy to have the [TETRAD manual](http://www.phil.cmu.edu/tetrad/revised%20Tetrad%20Manual-JUNE-2017.pdf) open.

**Phase 1:** Simulate data for a chain X -> Y -> Z and for a collider X -> Y <- Z. For each, write the data to a CSV file using the following. (Assuming that you will save this data in a folder called `tetrad`.)

```{r}
write.csv(sim_data, file = "tetrad/chain_binary.csv")
write.csv(sim_data, file = "tetrad/collider_binary.csv")
```

**Phase 2:** Exploration of TETRAD functionality as a class.

**Phase 3:** In groups, explore select aspects of the parameters window:

- Collider discovery: experiment with options 2 (CPC, the default) and 3 (Max-P)
- Cutoff for p-values


